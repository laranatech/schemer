(function(n,s){typeof exports=="object"&&typeof module!="undefined"?s(exports):typeof define=="function"&&define.amd?define(["exports"],s):(n=typeof globalThis!="undefined"?globalThis:n||self,s(n.schemer={}))})(this,function(n){"use strict";var tr=Object.defineProperty,nr=Object.defineProperties;var or=Object.getOwnPropertyDescriptors;var M=Object.getOwnPropertySymbols;var sr=Object.prototype.hasOwnProperty,ir=Object.prototype.propertyIsEnumerable;var m=(n,s,i)=>s in n?tr(n,s,{enumerable:!0,configurable:!0,writable:!0,value:i}):n[s]=i,I=(n,s)=>{for(var i in s||(s={}))sr.call(s,i)&&m(n,i,s[i]);if(M)for(var i of M(s))ir.call(s,i)&&m(n,i,s[i]);return n},P=(n,s)=>nr(n,or(s));var F=(n,s,i)=>m(n,typeof s!="symbol"?s+"":s,i);const s=r=>e=>{if(e>=r)return!0;throw new Error(`${e} cannot be less than ${r}`)},i=r=>e=>{if(e<=r)return!0;throw new Error(`${e} cannot be greater than ${r}`)},q=r=>e=>{if(e===r)return!0;throw new Error(`${e} !== ${r}`)},k=r=>e=>{if(e.length>=r)return!0;throw new Error(`The value's length (${e.length}) is too short. Min: ${r}`)},V=r=>e=>{if(e.length<=r)return!0;throw new Error(`The value's length (${e.length}) is too long. Min: ${r}`)},z=r=>e=>{if(e.length===r)return!0;throw new Error(`The value's length (${e.length}) !== ${r}`)},L=()=>r=>{if(r<0)return!0;throw new Error(`Value must be negative: ${r}`)},f=()=>r=>{if(r>=0)return!0;throw new Error(`Value must be positive: ${r}`)},j=(r,e=void 0)=>{const t=new RegExp(r,e);return o=>{if(t.test(o))return!0;throw new Error(`${o} doesn't match the pattern: ${String(r)}${e?"/"+String(e):""}`)}},y=r=>e=>{if(!r.includes(e))return!0;throw new Error(`${e} is forbidden: [${r.join(", ")}]`)},h=r=>e=>{if(r.includes(e))return!0;throw new Error(`${e} is not on the list: [${r.join(", ")}]`)},x=()=>r=>{const e=`The value cannot be empty: ${r}`;if(Array.isArray(r)||typeof r=="string"){if(r.length>0)return!0;throw new Error(e)}if(typeof r=="object"){if(Object.keys(r).length>0)return!0;throw new Error(e)}throw new Error(`Invalid value type: ${typeof r}`)},d=r=>e=>Object.keys(e).filter(t=>{try{return r(t)}catch(o){return!1}}),w=(r,e)=>r.length===e.length&&r.every((t,o)=>t===e[o]),R=Object.freeze(Object.defineProperty({__proto__:null,compareArrays:w,filterObjectKeys:d},Symbol.toStringTag,{value:"Module"})),E=r=>{const e=d(h(r));return t=>{const o=e(t);if(w(o,Object.keys(t)))return!0;const a=d(y(r))(t);throw new Error(`${t} has Invalid fields: [${a.join(", ")}]`)}},C=r=>{const e=d(y(r));return t=>{const o=e(t);if(w(o,Object.keys(t)))return!0;const a=d(h(r))(t);throw new Error(`${t} has Invalid fields: [${a.join(", ")}]`)}},g=()=>{const r=j(/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/);return e=>{try{return r(e),!0}catch(t){throw new Error(`Invalid email: ${e}`)}}},K=Object.freeze(Object.defineProperty({__proto__:null,allowedFields:E,allowlist:h,blockedFields:C,blocklist:y,email:g,exact:q,exactLength:z,max:i,maxLength:V,min:s,minLength:k,negative:L,notEmpty:x,positive:f,regexp:j},Symbol.toStringTag,{value:"Module"})),U=r=>{if(!Number.isNaN(r)&&typeof r=="number")return!0;throw new Error(`${r} is NaN`)},B=r=>{if(Number.isInteger(r))return!0;throw new Error(`Value must be integer: ${r}`)},D=r=>{if(typeof r=="string")return!0;throw new Error(`${r} is not a string`)},G=r=>{if(typeof r=="boolean")return!0;throw new Error(`${r} must be boolean`)},O=r=>{if(Array.isArray(r))return!0;throw new Error(`${r} must be an array`)},b=Object.freeze(Object.defineProperty({__proto__:null,array:O,bool:G,int:B,number:U,string:D},Symbol.toStringTag,{value:"Module"})),S=h(Object.keys(b)),_=(r,e)=>e==="any"?!0:(S(e),b[e](r)),T=(r,e,t="")=>(O(r),e.type instanceof p?r.every(o=>e.type.validate(o)):(S(e.type),r.every((o,u)=>l(o,e,`${t}[${u}]`)))),H=(r,e,t="")=>{if(e.nullable===!0&&r===null)return!0;if(r===null)throw new Error(`${t?t+" | ":""}Value cannot be null`);return!1},J=(r,e,t="")=>{if(e.required===!0&&r===void 0)throw new Error(`${t?t+" | ":""}Value is required`);return!0},Q=(r,e="")=>{if(typeof r!="object")throw new Error(`${e?e+" | ":""}Invalid config: ${r}`);return E(["type","required","rules","nullable"])(r)},l=(r,e,t="")=>typeof e=="string"?_(r,e):e instanceof p?e.validate(r):Array.isArray(e)&&e.length===1?T(r,{type:e[0]},t):(Q(e,t),J(r,e,t),H(r,e,t)?!0:Array.isArray(e.type)&&e.type.length===1?T(r,P(I({},e),{type:e.type[0]}),t):(_(r,e.type),e.rules&&e.rules.forEach(o=>o(r)),!0)),$=(r,e)=>{const t=Object.keys(e),o=Object.keys(r),u=[],a=t.filter(c=>e[c].required!==!0?!1:!o.includes(c));return a.length>0&&u.push(`Missing required fields: ${a.join(", ")}`),o.every(c=>{if(!t.includes(c)){u.push(`Unknown field: ${c}`);return}try{return l(r[c],e[c],c)}catch(er){u.push(er)}}),{success:u.length===0,errors:u}};class p{constructor(e){F(this,"schema",{});this.schema=e}validate(e){const{success:t,errors:o}=this.validateSafely(e);if(t)return!0;throw new Error(`Validation error:
${o.join(`
`)}`)}validateSafely(e){return $(e,this.schema)}}const W=(r,e,t="")=>{const o=[];try{l(r,e,t)}catch(u){o.push(u)}return{success:o.length===0,errors:o}},X=(r,e)=>{const{success:t,errors:o}=$(r,e);if(t)return!0;throw new Error(`Validation error:
${o.join(`
`)}`)},v={type:"string",rules:[g()]},Y=r=>l(r,v),A={type:"int",rules:[f()]},Z=r=>l(r,A),N={type:"number",rules:[f()]},rr=Object.freeze(Object.defineProperty({__proto__:null,email:v,positiveInt:A,positiveNumber:N,validateEmail:Y,validatePositiveInt:Z,validatePositiveNumber:r=>l(r,N)},Symbol.toStringTag,{value:"Module"}));n.Schemer=p,n.common=rr,n.rules=K,n.types=b,n.utils=R,n.validate=l,n.validateObject=X,n.validateObjectSafely=$,n.validateSafely=W,Object.defineProperty(n,Symbol.toStringTag,{value:"Module"})});
