(function(o,s){typeof exports=="object"&&typeof module!="undefined"?s(exports):typeof define=="function"&&define.amd?define(["exports"],s):(o=typeof globalThis!="undefined"?globalThis:o||self,s(o.schemer={}))})(this,function(o){"use strict";var x=Object.defineProperty;var K=(o,s,c)=>s in o?x(o,s,{enumerable:!0,configurable:!0,writable:!0,value:c}):o[s]=c;var j=(o,s,c)=>K(o,typeof s!="symbol"?s+"":s,c);const s=r=>e=>{if(e>=r)return!0;throw new Error(`${e} cannot be less than ${r}`)},c=r=>e=>{if(e<=r)return!0;throw new Error(`${e} cannot be greater than ${r}`)},g=r=>e=>{if(e===r)return!0;throw new Error(`${e} !== ${r}`)},m=r=>e=>{if(e.length>=r)return!0;throw new Error(`The value's length (${e.length}) is too short. Min: ${r}`)},O=r=>e=>{if(e.length<=r)return!0;throw new Error(`The value's length (${e.length}) is too long. Min: ${r}`)},S=r=>e=>{if(e.length===r)return!0;throw new Error(`The value's length (${e.length}) !== ${r}`)},_=()=>r=>{if(r<0)return!0;throw new Error(`Value must be negative: ${r}`)},T=()=>r=>{if(r>=0)return!0;throw new Error(`Value must be positive: ${r}`)},$=(r,e=void 0)=>{const t=new RegExp(r,e);return n=>{if(t.test(n))return!0;throw new Error(`${n} doesn't match the pattern: ${String(r)}${e?"/"+String(e):""}`)}},a=r=>e=>{if(!r.includes(e))return!0;throw new Error(`${e} is forbidden: [${r.join(", ")}]`)},d=r=>e=>{if(r.includes(e))return!0;throw new Error(`${e} is not on the list: [${r.join(", ")}]`)},F=()=>r=>{const e=`The value cannot be empty: ${r}`;if(Array.isArray(r)||typeof r=="string"){if(r.length>0)return!0;throw new Error(e)}if(typeof r=="object"){if(Object.keys(r).length>0)return!0;throw new Error(e)}throw new Error(`Invalid value type: ${typeof r}`)},h=r=>e=>Object.keys(e).filter(t=>{try{return r(t)}catch(n){return!1}}),y=(r,e)=>r.length===e.length&&r.every((t,n)=>t===e[n]),M=Object.freeze(Object.defineProperty({__proto__:null,compareArrays:y,filterObjectKeys:h},Symbol.toStringTag,{value:"Module"})),p=r=>{const e=h(d(r));return t=>{const n=e(t);if(y(n,Object.keys(t)))return!0;const l=h(a(r))(t);throw new Error(`${t} has Invalid fields: [${l.join(", ")}]`)}},A=Object.freeze(Object.defineProperty({__proto__:null,allowedFields:p,allowlist:d,blockedFields:r=>{const e=h(a(r));return t=>{const n=e(t);if(y(n,Object.keys(t)))return!0;const l=h(d(r))(t);throw new Error(`${t} has Invalid fields: [${l.join(", ")}]`)}},blocklist:a,email:()=>{const r=$(/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/);return e=>{try{return r(e),!0}catch(t){throw new Error(`Invalid email: ${e}`)}}},exact:g,exactLength:S,max:c,maxLength:O,min:s,minLength:m,negative:_,notEmpty:F,positive:T,regexp:$},Symbol.toStringTag,{value:"Module"})),k=r=>{if(!Number.isNaN(r)&&typeof r=="number")return!0;throw new Error(`${r} is NaN`)},I=r=>{if(Number.isInteger(r))return!0;throw new Error(`Value must integer: ${r}`)},N=r=>{if(typeof r=="string")return!0;throw new Error(`${r} is not a string`)},q=r=>{if(typeof r=="boolean")return!0;throw new Error(`${r} must be boolean`)},E=r=>{if(Array.isArray(r))return!0;throw new Error(`${r} must be an array`)},f=Object.freeze(Object.defineProperty({__proto__:null,array:E,bool:q,int:I,number:k,string:N},Symbol.toStringTag,{value:"Module"})),w=(r,e,t="")=>{const n=d(Object.keys(f));if(typeof e=="string")return n(e),f[e](r);if(Array.isArray(e)&&e.length===1)return E(r)&&r.every(i=>w(i,e[0]));if(typeof e!="object")throw new Error(`${t?t+" | ":""}Invalid config: ${e}`);if(p(["type","required","rules","nullable"])(e),e.required===!0&&r===void 0)throw new Error(`${t?t+" | ":""}Value is required`);if(e.nullable===!0&&r===null)return!0;if(r===null)throw new Error(`${t?t+" | ":""}Value cannot be null`);return n(e.type),f[e.type](r),e.rules&&e.rules.forEach(i=>{i(r)}),!0},b=(r,e)=>{const t=Object.keys(e),n=Object.keys(r),i=[],l=t.filter(u=>e[u].required!==!0?!1:!n.includes(u));return l.length>0&&i.push(`Missing required fields: ${l.join(", ")}`),n.every(u=>{if(!t.includes(u)){i.push(`Unknown field: ${u}`);return}try{return w(r[u],e[u],u)}catch(L){i.push(L)}}),{success:i.length===0,errors:i}};class V{constructor(e){j(this,"schema",{});this.schema=e}validate(e){const{success:t,errors:n}=this.validateSafely(e);if(t)return!0;throw new Error(`Validation error:
${n.join(`
`)}`)}validateSafely(e){return b(e,this.schema)}}const P=(r,e,t="")=>{const n=[];try{w(r,e,t)}catch(i){n.push(i)}return{success:n.length===0,errors:n}},z=(r,e)=>{const{success:t,errors:n}=b(r,e);if(t)return!0;throw new Error(`Validation error:
${n.join(`
`)}`)};o.Schemer=V,o.rules=A,o.types=f,o.utils=M,o.validate=w,o.validateObject=z,o.validateObjectSafely=b,o.validateSafely=P,Object.defineProperty(o,Symbol.toStringTag,{value:"Module"})});
