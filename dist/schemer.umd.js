(function(o,s){typeof exports=="object"&&typeof module!="undefined"?s(exports):typeof define=="function"&&define.amd?define(["exports"],s):(o=typeof globalThis!="undefined"?globalThis:o||self,s(o.schemer={}))})(this,function(o){"use strict";var or=Object.defineProperty,sr=Object.defineProperties;var ir=Object.getOwnPropertyDescriptors;var q=Object.getOwnPropertySymbols;var ur=Object.prototype.hasOwnProperty,cr=Object.prototype.propertyIsEnumerable;var g=(o,s,i)=>s in o?or(o,s,{enumerable:!0,configurable:!0,writable:!0,value:i}):o[s]=i,F=(o,s)=>{for(var i in s||(s={}))ur.call(s,i)&&g(o,i,s[i]);if(q)for(var i of q(s))cr.call(s,i)&&g(o,i,s[i]);return o},v=(o,s)=>sr(o,ir(s));var k=(o,s,i)=>g(o,typeof s!="symbol"?s+"":s,i);const s=r=>e=>{if(e>=r)return!0;throw new Error(`${e} cannot be less than ${r}`)},i=r=>e=>{if(e<=r)return!0;throw new Error(`${e} cannot be greater than ${r}`)},V=r=>e=>{if(e===r)return!0;throw new Error(`${e} !== ${r}`)},z=r=>e=>{if(e.length>=r)return!0;throw new Error(`The value's length (${e.length}) is too short. Min: ${r}`)},L=r=>e=>{if(e.length<=r)return!0;throw new Error(`The value's length (${e.length}) is too long. Min: ${r}`)},x=r=>e=>{if(e.length===r)return!0;throw new Error(`The value's length (${e.length}) !== ${r}`)},C=()=>r=>{if(r<0)return!0;throw new Error(`Value must be negative: ${r}`)},y=()=>r=>{if(r>=0)return!0;throw new Error(`Value must be positive: ${r}`)},w=(r,e=void 0)=>{const t=new RegExp(r,e);return n=>{if(t.test(n))return!0;throw new Error(`${n} doesn't match the pattern: ${String(r)}${e?"/"+String(e):""}`)}},b=r=>e=>{if(!r.includes(e))return!0;throw new Error(`${e} is forbidden: [${r.join(", ")}]`)},f=r=>e=>{if(r.includes(e))return!0;throw new Error(`${e} is not on the list: [${r.join(", ")}]`)},R=()=>r=>{const e=`The value cannot be empty: ${r}`;if(Array.isArray(r)||typeof r=="string"){if(r.length>0)return!0;throw new Error(e)}if(typeof r=="object"){if(Object.keys(r).length>0)return!0;throw new Error(e)}throw new Error(`Invalid value type: ${typeof r}`)},d=r=>e=>Object.keys(e).filter(t=>{try{return r(t)}catch(n){return!1}}),$=(r,e)=>r.length===e.length&&r.every((t,n)=>t===e[n]),h=r=>{const e=w(/^class\s/);try{return typeof r=="function"&&e(r)}catch(t){return!1}},K=Object.freeze(Object.defineProperty({__proto__:null,compareArrays:$,filterObjectKeys:d,isClass:h},Symbol.toStringTag,{value:"Module"})),O=r=>{const e=d(f(r));return t=>{const n=e(t);if($(n,Object.keys(t)))return!0;const a=d(b(r))(t);throw new Error(`${t} has Invalid fields: [${a.join(", ")}]`)}},U=r=>{const e=d(b(r));return t=>{const n=e(t);if($(n,Object.keys(t)))return!0;const a=d(f(r))(t);throw new Error(`${t} has Invalid fields: [${a.join(", ")}]`)}},S=()=>{const r=w(/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/);return e=>{try{return r(e),!0}catch(t){throw new Error(`Invalid email: ${e}`)}}},B=Object.freeze(Object.defineProperty({__proto__:null,allowedFields:O,allowlist:f,blockedFields:U,blocklist:b,email:S,exact:V,exactLength:x,max:i,maxLength:L,min:s,minLength:z,negative:C,notEmpty:R,positive:y,regexp:w},Symbol.toStringTag,{value:"Module"})),D=r=>{if(!Number.isNaN(r)&&typeof r=="number")return!0;throw new Error(`${r} is NaN`)},G=r=>{if(Number.isInteger(r))return!0;throw new Error(`Value must be integer: ${r}`)},H=r=>{if(typeof r=="string")return!0;throw new Error(`${r} is not a string`)},J=r=>{if(typeof r=="boolean")return!0;throw new Error(`${r} must be boolean`)},_=r=>{if(Array.isArray(r))return!0;throw new Error(`${r} must be an array`)},T=(r,e)=>{if(r instanceof e)return!0;throw new Error(`${r} is not an instance of ${e}`)},p=Object.freeze(Object.defineProperty({__proto__:null,array:_,bool:J,func:r=>{if(typeof r=="function")return!0;throw new Error(`${r} is not a function`)},instance:T,int:G,number:D,string:H},Symbol.toStringTag,{value:"Module"})),A=f(Object.keys(p)),E=(r,e)=>e==="any"?!0:h(e)?T(r,e):(A(e),p[e](r)),N=(r,e,t="")=>(_(r),e.type instanceof j?r.every(n=>e.type.validate(n)):h(e.type)?r.every(n=>E(n,e.type)):(A(e.type),r.every((n,u)=>l(n,e,`${t}[${u}]`)))),Q=(r,e,t="")=>{if(e.nullable===!0&&r===null)return!0;if(r===null)throw new Error(`${t?t+" | ":""}Value cannot be null`);return!1},W=(r,e,t="")=>{if(e.required===!0&&r===void 0)throw new Error(`${t?t+" | ":""}Value is required`);return e.required===!1&&r===void 0},X=(r,e="")=>{if(typeof r!="object")throw new Error(`${e?e+" | ":""}Invalid config: ${r}`);return O(["type","required","rules","nullable"])(r)},l=(r,e,t="")=>typeof e=="string"||h(e)?E(r,e):e instanceof j?e.validate(r):Array.isArray(e)&&e.length===1?N(r,{type:e[0]},t):(X(e,t),W(r,e,t)||Q(r,e,t)?!0:Array.isArray(e.type)&&e.type.length===1?N(r,v(F({},e),{type:e.type[0]}),t):(E(r,e.type),e.rules&&e.rules.forEach(n=>n(r)),!0)),m=(r,e)=>{const t=Object.keys(e),n=Object.keys(r),u=[],a=t.filter(c=>e[c].required!==!0?!1:!n.includes(c));return a.length>0&&u.push(`Missing required fields: ${a.join(", ")}`),n.every(c=>{if(!t.includes(c)){u.push(`Unknown field: ${c}`);return}try{return l(r[c],e[c],c)}catch(nr){u.push(nr)}}),{success:u.length===0,errors:u}};class j{constructor(e){k(this,"schema",{});this.schema=e}validate(e){const{success:t,errors:n}=this.validateSafely(e);if(t)return!0;throw new Error(`Validation error:
${n.join(`
`)}`)}validateSafely(e){return m(e,this.schema)}}const Y=(r,e,t="")=>{const n=[];try{l(r,e,t)}catch(u){n.push(u)}return{success:n.length===0,errors:n}},Z=(r,e)=>{const{success:t,errors:n}=m(r,e);if(t)return!0;throw new Error(`Validation error:
${n.join(`
`)}`)},M={type:"string",rules:[S()]},rr=r=>l(r,M),I={type:"int",rules:[y()]},er=r=>l(r,I),P={type:"number",rules:[y()]},tr=Object.freeze(Object.defineProperty({__proto__:null,email:M,positiveInt:I,positiveNumber:P,validateEmail:rr,validatePositiveInt:er,validatePositiveNumber:r=>l(r,P)},Symbol.toStringTag,{value:"Module"}));o.Schemer=j,o.common=tr,o.rules=B,o.types=p,o.utils=K,o.validate=l,o.validateObject=Z,o.validateObjectSafely=m,o.validateSafely=Y,Object.defineProperty(o,Symbol.toStringTag,{value:"Module"})});
