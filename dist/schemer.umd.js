(function(n,s){typeof exports=="object"&&typeof module!="undefined"?s(exports):typeof define=="function"&&define.amd?define(["exports"],s):(n=typeof globalThis!="undefined"?globalThis:n||self,s(n.schemer={}))})(this,function(n){"use strict";var W=Object.defineProperty,X=Object.defineProperties;var Y=Object.getOwnPropertyDescriptors;var T=Object.getOwnPropertySymbols;var Z=Object.prototype.hasOwnProperty,rr=Object.prototype.propertyIsEnumerable;var m=(n,s,u)=>s in n?W(n,s,{enumerable:!0,configurable:!0,writable:!0,value:u}):n[s]=u,A=(n,s)=>{for(var u in s||(s={}))Z.call(s,u)&&m(n,u,s[u]);if(T)for(var u of T(s))rr.call(s,u)&&m(n,u,s[u]);return n},I=(n,s)=>X(n,Y(s));var M=(n,s,u)=>m(n,typeof s!="symbol"?s+"":s,u);const s=r=>e=>{if(e>=r)return!0;throw new Error(`${e} cannot be less than ${r}`)},u=r=>e=>{if(e<=r)return!0;throw new Error(`${e} cannot be greater than ${r}`)},N=r=>e=>{if(e===r)return!0;throw new Error(`${e} !== ${r}`)},P=r=>e=>{if(e.length>=r)return!0;throw new Error(`The value's length (${e.length}) is too short. Min: ${r}`)},F=r=>e=>{if(e.length<=r)return!0;throw new Error(`The value's length (${e.length}) is too long. Min: ${r}`)},k=r=>e=>{if(e.length===r)return!0;throw new Error(`The value's length (${e.length}) !== ${r}`)},q=()=>r=>{if(r<0)return!0;throw new Error(`Value must be negative: ${r}`)},y=()=>r=>{if(r>=0)return!0;throw new Error(`Value must be positive: ${r}`)},j=(r,e=void 0)=>{const t=new RegExp(r,e);return o=>{if(t.test(o))return!0;throw new Error(`${o} doesn't match the pattern: ${String(r)}${e?"/"+String(e):""}`)}},w=r=>e=>{if(!r.includes(e))return!0;throw new Error(`${e} is forbidden: [${r.join(", ")}]`)},h=r=>e=>{if(r.includes(e))return!0;throw new Error(`${e} is not on the list: [${r.join(", ")}]`)},v=()=>r=>{const e=`The value cannot be empty: ${r}`;if(Array.isArray(r)||typeof r=="string"){if(r.length>0)return!0;throw new Error(e)}if(typeof r=="object"){if(Object.keys(r).length>0)return!0;throw new Error(e)}throw new Error(`Invalid value type: ${typeof r}`)},a=r=>e=>Object.keys(e).filter(t=>{try{return r(t)}catch(o){return!1}}),b=(r,e)=>r.length===e.length&&r.every((t,o)=>t===e[o]),V=Object.freeze(Object.defineProperty({__proto__:null,compareArrays:b,filterObjectKeys:a},Symbol.toStringTag,{value:"Module"})),E=r=>{const e=a(h(r));return t=>{const o=e(t);if(b(o,Object.keys(t)))return!0;const d=a(w(r))(t);throw new Error(`${t} has Invalid fields: [${d.join(", ")}]`)}},z=r=>{const e=a(w(r));return t=>{const o=e(t);if(b(o,Object.keys(t)))return!0;const d=a(h(r))(t);throw new Error(`${t} has Invalid fields: [${d.join(", ")}]`)}},g=()=>{const r=j(/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/);return e=>{try{return r(e),!0}catch(t){throw new Error(`Invalid email: ${e}`)}}},L=Object.freeze(Object.defineProperty({__proto__:null,allowedFields:E,allowlist:h,blockedFields:z,blocklist:w,email:g,exact:N,exactLength:k,max:u,maxLength:F,min:s,minLength:P,negative:q,notEmpty:v,positive:y,regexp:j},Symbol.toStringTag,{value:"Module"})),x=r=>{if(!Number.isNaN(r)&&typeof r=="number")return!0;throw new Error(`${r} is NaN`)},C=r=>{if(Number.isInteger(r))return!0;throw new Error(`Value must be integer: ${r}`)},K=r=>{if(typeof r=="string")return!0;throw new Error(`${r} is not a string`)},R=r=>{if(typeof r=="boolean")return!0;throw new Error(`${r} must be boolean`)},$=r=>{if(Array.isArray(r))return!0;throw new Error(`${r} must be an array`)},f=Object.freeze(Object.defineProperty({__proto__:null,array:$,bool:R,int:C,number:x,string:K},Symbol.toStringTag,{value:"Module"})),l=(r,e,t="")=>{const o=h(Object.keys(f));if(typeof e=="string")return e==="any"?!0:(o(e),f[e](r));if(Array.isArray(e)&&e.length===1)return o(e[0]),$(r)&&r.every(i=>l(i,e[0]));if(typeof e!="object")throw new Error(`${t?t+" | ":""}Invalid config: ${e}`);if(E(["type","required","rules","nullable"])(e),e.required===!0&&r===void 0)throw new Error(`${t?t+" | ":""}Value is required`);if(e.nullable===!0&&r===null)return!0;if(r===null)throw new Error(`${t?t+" | ":""}Value cannot be null`);if(Array.isArray(e.type)&&e.type.length===1){const i=I(A({},e),{type:e.type[0]});return $(r)&&r.every((d,c)=>l(d,i,`${t}[${c}]`))}return o(e.type),f[e.type](r),e.rules&&e.rules.forEach(i=>{i(r)}),!0},p=(r,e)=>{const t=Object.keys(e),o=Object.keys(r),i=[],d=t.filter(c=>e[c].required!==!0?!1:!o.includes(c));return d.length>0&&i.push(`Missing required fields: ${d.join(", ")}`),o.every(c=>{if(!t.includes(c)){i.push(`Unknown field: ${c}`);return}try{return l(r[c],e[c],c)}catch(Q){i.push(Q)}}),{success:i.length===0,errors:i}};class U{constructor(e){M(this,"schema",{});this.schema=e}validate(e){const{success:t,errors:o}=this.validateSafely(e);if(t)return!0;throw new Error(`Validation error:
${o.join(`
`)}`)}validateSafely(e){return p(e,this.schema)}}const B=(r,e,t="")=>{const o=[];try{l(r,e,t)}catch(i){o.push(i)}return{success:o.length===0,errors:o}},D=(r,e)=>{const{success:t,errors:o}=p(r,e);if(t)return!0;throw new Error(`Validation error:
${o.join(`
`)}`)},O={type:"string",rules:[g()]},G=r=>l(r,O),S={type:"int",rules:[y()]},H=r=>l(r,S),_={type:"number",rules:[y()]},J=Object.freeze(Object.defineProperty({__proto__:null,email:O,positiveInt:S,positiveNumber:_,validateEmail:G,validatePositiveInt:H,validatePositiveNumber:r=>l(r,_)},Symbol.toStringTag,{value:"Module"}));n.Schemer=U,n.common=J,n.rules=L,n.types=f,n.utils=V,n.validate=l,n.validateObject=D,n.validateObjectSafely=p,n.validateSafely=B,Object.defineProperty(n,Symbol.toStringTag,{value:"Module"})});
